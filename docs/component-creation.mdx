# Component Creation Guide

See also:

- Semantic tokens and usage: `docs/semantic-tokens.mdx`
- Storybook authoring standards: `docs/storybook-guidelines.mdx`
- Test guidance: `docs/testing-guidelines.mdx`

## üìÅ File Structure

```
ComponentName/
‚îú‚îÄ‚îÄ ComponentName.component.tsx
‚îú‚îÄ‚îÄ ComponentName.types.ts
‚îú‚îÄ‚îÄ ComponentName.variants.ts
‚îú‚îÄ‚îÄ ComponentName.stories.tsx
‚îî‚îÄ‚îÄ index.ts
```

## üöÄ Templates

### Interactive Components (Button, Select, etc.)

**Variants:**

```typescript
import { cva, type VariantProps } from 'class-variance-authority';

export const componentVariants = cva(
	[
		'inline-flex',
		'items-center',
		'justify-center',
		'rounded-md',
		'font-medium',
		'transition-all',
		'duration-300',
		'focus-visible:outline-none',
	],
	{
		variants: {
			variant: { solid: [], outline: [], ghost: [], link: [] },
			colorScheme: { primary: [], secondary: [], success: [], warning: [], error: [], info: [], muted: [] },
			size: {
				sm: ['px-3', 'py-1.5', 'text-sm'],
				md: ['px-4', 'py-2', 'text-base'],
				lg: ['px-6', 'py-3', 'text-lg'],
			},
			fullWidth: { true: 'w-full', false: 'w-auto' },
			loading: { true: 'cursor-wait', false: '' },
		},
		compoundVariants: [
			{ variant: 'solid', colorScheme: 'primary', class: 'bg-primary-600 hover:bg-primary-500 text-white' },
			{ variant: 'outline', colorScheme: 'primary', class: 'border-primary-600 text-primary-600 hover:bg-primary-50' },
			{ variant: 'ghost', colorScheme: 'primary', class: 'text-primary-600 hover:bg-primary-50' },
			{
				variant: 'link',
				colorScheme: 'primary',
				class: 'text-primary-600 hover:text-primary-500 px-0 underline-offset-4 hover:underline',
			},
		],
		defaultVariants: { variant: 'solid', colorScheme: 'primary', size: 'md', fullWidth: false, loading: false },
	}
);

export type ComponentVariantProps = VariantProps<typeof componentVariants>;
```

**Component:**

```typescript
import React from 'react';
import { mergeClassNames } from '@mirai-ui/utils';
import { componentVariants } from './Component.variants';
import type { ComponentProps } from './Component.types';

export const Component = React.forwardRef<HTMLButtonElement, ComponentProps>(
	({ variant, colorScheme, size, fullWidth, loading, className, children, ...props }, ref) => {
		return (
			<button
				ref={ref}
				className={mergeClassNames(
					componentVariants({ variant, colorScheme, size, fullWidth, loading }),
					className
				)}
				aria-busy={Boolean(loading)}
				disabled={Boolean(loading || props.disabled)}
				{...props}
			>
				{children}
			</button>
		);
	}
);

Component.displayName = 'Component';
```

### Form Components (Input, Textarea, etc.)

**Variants:**

```typescript
export const inputVariants = cva(
	[
		'block',
		'w-full',
		'rounded-md',
		'transition-all',
		'duration-200',
		'focus-visible:outline-none',
		'placeholder:text-muted-400',
	],
	{
		variants: {
			variant: {
				default: ['border', 'bg-input'],
				outlined: ['border-1', 'bg-transparent'],
				filled: ['border', 'border-transparent', 'shadow-xs'],
				borderless: ['border-0', 'bg-transparent', 'shadow-none'],
				underlined: ['border-0', 'border-b-2', 'bg-transparent', 'rounded-none', 'shadow-none', 'px-0'],
			},
			state: { default: [], error: [], success: [], warning: [] },
			size: { sm: ['px-3', 'py-1.5', 'text-sm'], md: ['px-4', 'py-2', 'text-base'] },
			fullWidth: { true: 'w-full', false: 'w-auto' },
		},
		compoundVariants: [
			{ variant: 'default', state: 'default', class: 'border-input-border text-foreground focus:border-primary-500' },
			{ variant: 'default', state: 'error', class: 'border-error-500 text-foreground focus:border-error-600' },
		],
		defaultVariants: { variant: 'default', state: 'default', size: 'md', fullWidth: true },
	}
);
```

### Display Components (Card, Typography, etc.)

**Variants:**

```typescript
export const cardVariants = cva(['rounded-md', 'border'], {
	variants: {
		variant: {
			default: ['bg-card', 'border-border'],
			elevated: ['bg-card', 'shadow-md', 'border-transparent'],
		},
		padding: { sm: ['p-4'], md: ['p-6'], lg: ['p-8'] },
	},
	defaultVariants: { variant: 'default', padding: 'md' },
});
```

## üìù Types Template

```typescript
import type { ComponentVariantProps } from './Component.variants';

export interface ComponentProps extends React.ButtonHTMLAttributes<HTMLButtonElement>, ComponentVariantProps {}

export interface InputProps extends React.InputHTMLAttributes<HTMLInputElement>, InputVariantProps {
	label?: string;
	helperText?: string;
	error?: string;
}

export interface CardProps extends React.HTMLAttributes<HTMLDivElement>, CardVariantProps {}
```

## üìñ Stories Template

```typescript
import type { Meta, StoryObj } from '@storybook/react-vite';
import { Component } from './Component.component';

const meta: Meta<typeof Component> = {
	title: 'Components/Component',
	component: Component,
	tags: ['autodocs'],
	args: { children: 'Component', variant: 'solid', colorScheme: 'primary', size: 'md' },
};

export default meta;
type Story = StoryObj<typeof Component>;

export const Default: Story = {};

export const AllVariants: Story = {
	render: () => (
		<div className="flex gap-4">
			<Component variant="solid">Solid</Component>
			<Component variant="outline">Outline</Component>
			<Component variant="ghost">Ghost</Component>
			<Component variant="link">Link</Component>
		</div>
	),
};
```

## üé® Design Tokens

**Colors:** `primary`, `secondary`, `success`, `warning`, `error`, `info`, `muted`, `accent`
**Sizes:** `sm`, `md`, `lg`, `xl`
**Spacing:** `px-3 py-1.5` (sm), `px-4 py-2` (md), `px-6 py-3` (lg)

## ‚úÖ Checklist

- [ ] Use `React.forwardRef` + `displayName`
- [ ] CVA for styling variants
- [ ] Extend appropriate HTML interfaces
- [ ] Use `mergeClassNames` utility
- [ ] Add accessibility attributes
- [ ] Create Storybook stories
- [ ] Export from `index.ts` and main `src/components/index.ts`

### Post-Generation Verification

Before committing, follow the workflow in `docs/code-generation-workflow.mdx`:

1. Write/update tests, including accessibility
2. Run linting and fix issues
3. Run type checking and fix errors
4. Run tests and ensure everything passes
